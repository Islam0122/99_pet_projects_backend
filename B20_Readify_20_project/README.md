# üìù ToDoList Telegram Bot

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π Telegram-–±–æ—Ç–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ —á–µ—Ä–µ–∑ Celery –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å Django REST API.

–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:

* **Backend:** Django + Django REST Framework (DRF)
* **Telegram Bot:** Aiogram + Aiogram-Dialog
* **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:** Celery + Redis
* **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL
* **Docker:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

---

## ‚ö° –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

* –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏ —á–µ—Ä–µ–∑ Telegram –∏ REST API
* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–¥–∞—á (—Ç–µ–≥–∏)
* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Telegram:

  * –°–æ–∑–¥–∞–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞
  * –î–µ–¥–ª–∞–π–Ω –∑–∞–¥–∞—á–∏
  * –ù–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

  * –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
  * –°–µ—Ä–∏—è –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥ —Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∑–∞–¥–∞—á
* –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á —á–µ—Ä–µ–∑ Aiogram-Dialog

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Telegram Bot <--> DRF API <--> PostgreSQL
         |             |
         |             v
         |          Celery <--> Redis (–ë—Ä–æ–∫–µ—Ä)
         |             |
         v             v
    Aiogram-Dialog  –§–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞—á
```

### Docker —Å–µ—Ä–≤–∏—Å—ã

| –°–µ—Ä–≤–∏—Å          | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                                 |
| --------------- | -------------------------------------------------------------------------- |
| `web`           | Django + DRF API ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π backend –∏ REST API. –í—ã–ø–æ–ª–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä –Ω–∞ `0.0.0.0:8000`. |
| `bot`           | Telegram Bot ‚Äî –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —á–µ—Ä–µ–∑ Aiogram + Aiogram-Dialog. |
| `celery_worker` | –§–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞—á —á–µ—Ä–µ–∑ Celery (–æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –∑–∞–¥–∞—á–∏ —Å –¥–µ–¥–ª–∞–π–Ω–∞–º–∏). |
| `celery_beat`   | –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á Celery Beat (—Ä–µ–≥—É–ª—è—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π). |
| `redis`         | –ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è Celery (—Ö—Ä–∞–Ω–∏—Ç –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á).                        |
| `db`            | PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∑–∞–¥–∞—á –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π.     |

---

## üóÑ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  TGUser  ‚îÇ      *‚îÇ   Task     ‚îÇ*     *‚îÇ Category  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§       ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§       ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ id       ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ owner_id   ‚îÇ       ‚îÇ id        ‚îÇ
‚îÇ telegram_id ‚îÇ     ‚îÇ title     ‚îÇ       ‚îÇ name      ‚îÇ
‚îÇ username ‚îÇ       ‚îÇ description‚îÇ       ‚îÇ created_at‚îÇ
‚îÇ streak_days‚îÇ      ‚îÇ due_date  ‚îÇ       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ last_task_completed‚îÇ done     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ created_reminder_sent ‚îÇ
                   ‚îÇ due_reminder_sent    ‚îÇ
                   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### **TGUser**

–•—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Telegram.

| –ü–æ–ª–µ                   | –¢–∏–ø           | –û–ø–∏—Å–∞–Ω–∏–µ                             |
| ---------------------- | ------------- | ------------------------------------ |
| `telegram_id`          | CharField     | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è           |
| `username`             | CharField     | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)     |
| `created_at`           | DateTimeField | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è                        |
| `total_task_completes` | IntegerField  | –ö–æ–ª-–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á             |
| `streak_days`          | IntegerField  | –°–µ—Ä–∏—è –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥                    |
| `last_task_completed`  | DateTimeField | –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è |

–ú–µ—Ç–æ–¥—ã:

* `update_streak()` ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–µ—Ä–∏—é –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥.

---

### **Category**

–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ (—Ç–µ–≥–∏) –¥–ª—è –∑–∞–¥–∞—á.

| –ü–æ–ª–µ         | –¢–∏–ø           | –û–ø–∏—Å–∞–Ω–∏–µ                       |
| ------------ | ------------- | ------------------------------ |
| `id`         | SnowflakePK   | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏        |
| `name`       | CharField     | –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ |
| `created_at` | DateTimeField | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏        |

–°–≤—è–∑–∏:

* `tasks` ‚Äî ManyToMany —Å –º–æ–¥–µ–ª—å—é **Task**

---

### **Task**

–ú–æ–¥–µ–ª—å –∑–∞–¥–∞—á–∏.

| –ü–æ–ª–µ                    | –¢–∏–ø                   | –û–ø–∏—Å–∞–Ω–∏–µ                          |
| ----------------------- | --------------------- | --------------------------------- |
| `id`                    | SnowflakePK           | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–¥–∞—á–∏              |
| `title`                 | CharField             | –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏                   |
| `description`           | TextField             | –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏                   |
| `owner`                 | ForeignKey ‚Üí TGUser   | –í–ª–∞–¥–µ–ª–µ—Ü –∑–∞–¥–∞—á–∏                   |
| `categories`            | ManyToMany ‚Üí Category | –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–¥–∞—á–∏                  |
| `created_at`            | DateTimeField         | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è                     |
| `due_date`              | DateTimeField         | –î–µ–¥–ª–∞–π–Ω –∑–∞–¥–∞—á–∏                    |
| `done`                  | BooleanField          | –í—ã–ø–æ–ª–Ω–µ–Ω–∞ –∏–ª–∏ –Ω–µ—Ç                 |
| `created_reminder_sent` | BooleanField          | –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ |
| `due_reminder_sent`     | BooleanField          | –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –¥–µ–¥–ª–∞–π–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ |

---

## üìù Celery –∑–∞–¥–∞—á–∏ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

1. **send_task_reminders**

   * –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á–∏
   * –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –ø—Ä–∏–±–ª–∏–∂–∞—é—â–µ–º—Å—è –¥–µ–¥–ª–∞–π–Ω–µ

2. **remind_unfinished_tasks**

   * –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö

Celery Beat Schedule –ø—Ä–∏–º–µ—Ä:

```python
CELERY_BEAT_SCHEDULE = {
    "send-task-reminders-every-5-min": {
        "task": "apps.tasks.tasks.send_task_reminders",
        "schedule": 300.0,
    },
    "remind-unfinished-tasks-every-10-min": {
        "task": "apps.tasks.tasks.remind_unfinished_tasks",
        "schedule": 600.0,
    },
}
```

---

## üê≥ Docker & –∑–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –°–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
docker-compose build
```

### 2. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
docker-compose up -d
```

### 3. –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
docker-compose exec web python manage.py migrate
```

### 4. –°–æ–∑–¥–∞–Ω–∏–µ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
docker-compose exec web python manage.py createsuperuser
```

### 5. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
docker-compose logs -f
```

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–µ—Ä–µ–∑ `.env`

```env
SECRET_KEY=
DEBUG=True
DJANGO_ENV=development
TELEGRAM_BOT_TOKEN=
TELEGRAM_API_URL=http://web:8000/api/v1
DB_NAME=
DB_USER=
DB_PASSWORD=
DB_HOST=
DB_PORT=5432
```



